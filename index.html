<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>진주 ITS (웹뷰 방식)</title>
<style>
  body { margin:0; font-family:system-ui, -apple-system, "Noto Sans KR", "Apple SD Gothic Neo", sans-serif; background:#f5f7fb; color:#222; }
  #frameWrap { width:100%; height:100vh; display:flex; align-items:stretch; justify-content:center; }
  iframe { width:100%; height:100vh; border:0; }
  .fallback { padding:24px; text-align:center; }
  .btn { display:inline-block; padding:10px 16px; border-radius:8px; background:#246; color:#fff; text-decoration:none; margin:8px; }
  .notice { color:#666; font-size:14px; margin-top:12px; }
</style>
</head>
<body>
<div id="frameWrap">
  <!-- 실제로 보여줄 대상 URL -->
  <iframe id="theFrame" src="https://its.jinju.go.kr/its/dsh/view" title="진주 ITS"></iframe>
</div>

<!-- 임베드 실패시 보여줄 대체 UI -->
<div id="fallback" class="fallback" style="display:none;">
  <h2>페이지를 임베드할 수 없습니다</h2>
  <p class="notice">해당 사이트가 외부 임베드를 차단했거나, 서버에서 연결을 거부했습니다.</p>
  <a id="openBtn" class="btn" href="https://its.jinju.go.kr/its/dsh/view" target="_blank" rel="noopener">새 탭에서 열기</a>
  <a id="openExternal" class="btn" href="#" onclick="openExternal();return false;">모바일 앱 웹뷰로 열기 (안드로이드 예)</a>
  <p class="notice">임베드가 차단되면, 페이지를 내 서버에서 중계(proxy)해야 내 도메인에서 그대로 보입니다. (법적·기술적 확인 필요)</p>
</div>

<script>
(function(){
  const iframe = document.getElementById('theFrame');
  const fallback = document.getElementById('fallback');
  const frameWrap = document.getElementById('frameWrap');
  // 타임아웃 기준: 3초 내에 iframe이 정상적으로 로드 이벤트를 보내면 OK.
  let loaded = false;
  const timeoutMs = 3000;

  iframe.addEventListener('load', () => {
    // load 이벤트가 와도 실제로 차단된 경우(빈 페이지)인지 알 수 없지만, 우선 load 발생 시 정상으로 간주
    loaded = true;
    // 작은 안정화 지연 후 아무 작업 안함
    setTimeout(()=>{ /* loaded ok */ }, 300);
  });

  // 타임아웃 후에도 로드되지 않으면 fallback으로 전환
  setTimeout(() => {
    if (!loaded) {
      // 숨기고 대체 UI 표시
      frameWrap.style.display = 'none';
      fallback.style.display = 'block';
    }
  }, timeoutMs);

  // 모바일 앱(안드로이드)에서 인텐트 방식으로 열기 (앱/웹뷰가 설치되어 있으면 앱으로 연결 시도)
  window.openExternal = function() {
    const url = 'https://its.jinju.go.kr/its/dsh/view';
    // 안드로이드 인텐트 예시 (브라우저별 동작 다름)
    window.location.href = url;
    // 또는 window.open(url, '_blank');
  };

})();
</script>
</body>
</html>
